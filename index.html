<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <link rel="icon" href="data:base64,=">
  <title>Tabularius — book-keeper for Tower Dominion</title>
  <meta name="og:site_name" content="Tabularius">
  <meta name="description" content="Book-keeper for Tower Dominion: run history, data analysis with plots, and more!">
  <meta name="og:description" content="Book-keeper for Tower Dominion: run history, save editing, data analysis with plots, and more!">

  <!-- Instruct robots to index only one route without URL query stuff. -->
  <link rel="canonical" href="https://mitranim.com/tabularius/">
  <script id="meta_script">
    document.getElementById(`meta_script`)?.remove()
    if (window.location.search !== ``) {
      const tar = document.createElement(`meta`)
      tar.name = `robots`
      tar.content = `noindex,follow`
      document.head.append(tar)
    }
  </script>

  <style>
    html, body {
      width: 100vw;
      height: 100vh;
    }

    * {
      font-family: ui-monospace, SF Mono, SFMono-Regular, Menlo, Monaco, DejaVu Sans Mono, Consolas, 'Liberation Mono', 'Courier New', monospace;
    }
  </style>

  <style id="loading_style">
    @media (prefers-color-scheme: dark) {
      :root {
        background-color: hsl(0deg 0% 10%);
        color: hsl(0deg 0% 80%);
      }
      a:link {color: deepskyblue}
      a:link:hover {color: dodgerblue}
    }
    @media (prefers-color-scheme: light) {
      :root {
        background-color: white;
        color: hsl(0deg 0% 30%);
      }
      a:link {color: blue}
      a:link:hover {color: blueviolet}
    }
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      line-height: 1.25;
    }
  </style>

  <script type="importmap">
    {"imports": {
      "tabularius/": "./client/",
      "@mitranim/js/": "https://cdn.jsdelivr.net/npm/@mitranim/js@0.1.65/",
      "@twind/core": "https://esm.sh/@twind/core@1.1.3",
      "@twind/preset-autoprefix": "https://esm.sh/@twind/preset-autoprefix@1.0.7",
      "@twind/preset-tailwind": "https://esm.sh/@twind/preset-tailwind@1.1.4",
      "@twind/preset-tailwind/": "https://esm.sh/@twind/preset-tailwind@1.1.4/",
      "idb": "https://esm.sh/idb@7.1.1",
      "uplot": "https://esm.sh/uplot@1.6.27",
      "tweetnacl": "https://cdn.skypack.dev/tweetnacl@1.0.3?min"
    }}
  </script>

  <script src="https://cdn.jsdelivr.net/npm/@ungap/custom-elements@1.3.0/es.js"></script>

  <!-- Showing initialization errors may help both users and developers. -->
  <script type="module">
    try {
      await import(`./client/main.mjs`)
    }
    catch (err) {
      console.error(err)

      if (document.getElementById(`loading_msg`)) {
        const TARBLAN = `target="_blank" rel="noopener noreferrer"`

        // SYNC[discord_link].
        const DISCORD_LINK = `https://discord.gg/upPxCEVxgD`

        // SYNC[discord_link].
        document.body.innerHTML = `
<p>Sorry! Something went wrong.</p>
<pre style="color: red; padding: 1rem; white-space: break-spaces">${err?.stack || err}</pre>
<p>
  Please report:
  <br>
  Via <a href="https://github.com/mitranim/tabularius/issues" ${TARBLAN}>GitHub issues ↗</a>
  <br>
  Via <a href="${DISCORD_LINK}" ${TARBLAN}>Tower Dominion Discord ↗</a>, tagging @mitranim
</p>
`
      }
    }
  </script>

  <!--
  Alternative: just use normal module loading and hope for the best.

  <script type="module" src="./client/main.mjs"></script>
  -->
</head>

<body>
  <noscript>
    The app requires JavaScript.
    <br>
    Please enable JS in your browser settings.
    <style>#loading_msg {display: none}</style>
  </noscript>

  <div id="loading_msg">Loading...</div>

  <script>navigator.serviceWorker.register(`./sw.mjs`)</script>
</body>
</html>
